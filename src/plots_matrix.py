import numpy as np
import matplotlib.pyplot as plt

def plot_confusion_matrix(matrix, classes):
    """
    Función para trazar una matriz de confusión.
    
    Args:
    - matrix (np.ndarray): Matriz de confusión.
    - classes (list): Lista de nombres de las clases.
    """
    plt.imshow(matrix, interpolation='nearest', cmap=plt.cm.Blues)
    plt.title('Matriz de Confusión')
    plt.colorbar()
    tick_marks = np.arange(len(classes))
    plt.xticks(tick_marks, classes, rotation=45)
    plt.yticks(tick_marks, classes)

    thresh = matrix.max() / 2.
    for i in range(matrix.shape[0]):
        for j in range(matrix.shape[1]):
            plt.text(j, i, format(matrix[i, j], 'd'),
                     horizontalalignment="center",
                     color="white" if matrix[i, j] > thresh else "black")

    plt.tight_layout()
    plt.ylabel('Etiqueta Verdadera')
    plt.xlabel('Etiqueta Predicha')
    plt.show()

# Definir las clases
classes = ["Clase 1", "Clase 2", "Clase 3", "Clase 4", "Clase 5", "Clase 6", "Clase 7"]

# Definir las matrices de confusión
# matrices_confusion = [
#     np.array([[45, 0, 0, 11, 0, 2, 0], [0, 41, 3, 14, 0, 0, 0], [0, 5, 62, 3, 1, 0, 0], [4, 0, 0, 54, 0, 0, 0], [0, 0, 1, 0, 58, 0, 1], [5, 0, 0, 0, 0, 50, 0], [0, 0, 0, 0, 0, 0, 65]]),
#     np.array([[45, 0, 0, 11, 0, 2, 0], [0, 39, 4, 14, 1, 0, 0], [0, 1, 68, 0, 1, 0, 1], [2, 0, 0, 56, 0, 0, 0], [0, 0, 2, 0, 57, 0, 1], [5, 0, 0, 0, 0, 50, 0], [0, 0, 0, 0, 0, 0, 65]]),
#     np.array([[38, 8, 0, 11, 0, 1, 0], [0, 46, 11, 1, 0, 0, 0], [0, 3, 64, 3, 1, 0, 0], [4, 22, 0, 32, 0, 0, 0], [0, 0, 2, 0, 57, 0, 1], [6, 0, 0, 0, 0, 49, 0], [0, 0, 0, 0, 0, 0, 65]]),
#     np.array([[50, 0, 0, 6, 0, 2, 0], [0, 47, 3, 8, 0, 0, 0], [0, 1, 69, 0, 1, 0, 0], [1, 1, 0, 56, 0, 0, 0], [0, 0, 3, 0, 56, 0, 1], [1, 0, 0, 0, 0, 54, 0], [0, 0, 0, 0, 0, 0, 65]]),
#     np.array([[52, 1, 0, 3, 0, 2, 0], [0, 49, 3, 6, 0, 0, 0], [0, 1, 67, 2, 1, 0, 0], [1, 2, 0, 55, 0, 0, 0], [0, 0, 3, 0, 56, 0, 1], [2, 0, 0, 0, 0, 53, 0], [0, 0, 0, 0, 0, 0, 65]]),
#     np.array([[51, 0, 0, 5, 0, 2, 0], [0, 50, 2, 5, 1, 0, 0], [0, 1, 68, 2, 0, 0, 0], [1, 1, 0, 56, 0, 0, 0], [0, 0, 2, 0, 57, 0, 1], [1, 0, 0, 0, 0, 54, 0], [0, 0, 0, 0, 0, 0, 65]]),
#     np.array([[51, 0, 0, 5, 0, 2, 0], [0, 49, 4, 5, 0, 0, 0], [0, 1, 67, 2, 1, 0, 0], [1, 1, 0, 56, 0, 0, 0], [0, 0, 1, 0, 58, 0, 1], [1, 0, 0, 0, 0, 54, 0], [0, 0, 0, 0, 0, 0, 65]]),
#     np.array([[50, 0, 0, 6, 0, 2, 0], [0, 50, 3, 5, 0, 0, 0], [0, 1, 67, 2, 1, 0, 0], [1, 1, 0, 56, 0, 0, 0], [0, 0, 1, 0, 58, 0, 1], [1, 0, 0, 0, 0, 54, 0], [0, 0, 0, 0, 0, 0, 65]])
# ]

# matrices_confusion = [
#     np.array([[32, 5, 6, 6, 1, 8, 0], [1, 43, 3, 8, 1, 1, 1], [3, 1, 62, 3, 1, 1, 0], [5, 4, 2, 46, 1, 0, 0], [0, 1, 2, 1, 55, 1, 0], [6, 0, 0, 0, 0, 49, 0], [0, 1, 0, 0, 0, 0, 64]]),
#     np.array([[33, 3, 6, 5, 0, 11, 0], [7, 32, 7, 6, 4, 1, 1], [6, 0, 64, 0, 0, 1, 0], [8, 0, 3, 45, 1, 1, 0], [1, 1, 4, 0, 53, 1, 0], [2, 0, 0, 0, 0, 53, 0], [0, 1, 0, 0, 0, 0, 64]]),
#     np.array([[30, 6, 7, 6, 1, 8, 0], [5, 37, 6, 4, 2, 3, 1], [5, 2, 59, 1, 3, 1, 0], [6, 2, 2, 46, 1, 1, 0], [2, 1, 2, 0, 54, 1, 0], [4, 0, 0, 0, 0, 51, 0], [0, 1, 0, 0, 0, 0, 64]]),
#     np.array([[28, 7, 6, 6, 1, 10, 0], [5, 39, 5, 4, 2, 2, 1], [4, 2, 63, 0, 0, 1, 1], [7, 2, 6, 40, 1, 2, 0], [1, 0, 3, 0, 55, 1, 0], [2, 0, 0, 0, 0, 53, 0], [0, 1, 0, 0, 0, 0, 64]]),
#     np.array([[33, 8, 3, 9, 1, 4, 0], [5, 35, 8, 6, 2, 1, 1], [4, 2, 58, 2, 3, 1, 1], [5, 1, 6, 43, 1, 2, 0], [1, 0, 3, 0, 55, 1, 0], [4, 0, 0, 0, 0, 51, 0], [0, 1, 0, 0, 0, 0, 64]]),
#     np.array([[30, 7, 6, 8, 1, 6, 0], [4, 34, 9, 6, 3, 1, 1], [2, 2, 60, 2, 3, 1, 1], [3, 2, 7, 42, 2, 2, 0], [1, 0, 3, 0, 55, 1, 0], [4, 0, 0, 0, 0, 51, 0], [0, 1, 0, 0, 0, 0, 64]]),
#     np.array([[29, 7, 6, 8, 1, 6, 1], [5, 35, 8, 5, 3, 1, 1], [2, 3, 59, 2, 3, 1, 1], [5, 1, 5, 42, 3, 2, 0], [1, 1, 2, 0, 55, 1, 0], [4, 0, 2, 0, 0, 49, 0], [0, 1, 0, 0, 0, 0, 64]]),
#     np.array([[21, 10, 7, 7, 3, 9, 1], [3, 32, 7, 5, 7, 3, 1], [2, 7, 52, 1, 4, 1, 4], [4, 2, 10, 34, 4, 4, 0], [1, 0, 1, 0, 57, 1, 0], [6, 1, 3, 0, 1, 44, 0], [0, 1, 0, 0, 0, 0, 64]]),
#     np.array([[11, 11, 11, 6, 6, 10, 3], [3, 18, 5, 3, 14, 12, 3], [1, 7, 44, 0, 11, 2, 6], [2, 4, 15, 12, 15, 2, 8], [0, 0, 0, 0, 55, 4, 1], [2, 2, 6, 1, 3, 41, 0], [0, 1, 0, 0, 0, 0, 64]])
# ]

# matrices_confusion = [
#     np.array([[50, 5, 1, 0, 2, 0, 0], [0, 56, 2, 0, 0, 0, 0], [0, 2, 56, 0, 0, 0, 0], [0, 0, 1, 69, 0, 1, 0], [2, 0, 0, 0, 53, 0, 0], [0, 0, 0, 2, 0, 57, 1], [0, 0, 0, 0, 0, 1, 64]]),
#     np.array([[47, 4, 1, 0, 6, 0, 0], [1, 56, 1, 0, 0, 0, 0], [0, 2, 56, 0, 0, 0, 0], [0, 0, 1, 68, 0, 2, 0], [2, 0, 0, 0, 53, 0, 0], [0, 0, 0, 0, 0, 59, 1], [0, 0, 0, 0, 0, 1, 64]]),
#     np.array([[50, 6, 0, 0, 2, 0, 0], [5, 51, 2, 0, 0, 0, 0], [0, 4, 48, 6, 0, 0, 0], [1, 0, 4, 65, 0, 1, 0], [4, 0, 0, 0, 51, 0, 0], [0, 0, 0, 3, 0, 57, 0], [0, 0, 0, 1, 0, 0, 64]]),
#     np.array([[52, 3, 0, 0, 3, 0, 0], [0, 55, 3, 0, 0, 0, 0], [0, 3, 54, 1, 0, 0, 0], [0, 0, 2, 67, 0, 2, 0], [1, 0, 0, 0, 54, 0, 0], [0, 0, 0, 1, 0, 58, 1], [0, 0, 0, 0, 0, 1, 64]]),
#     np.array([[47, 6, 1, 0, 4, 0, 0], [2, 53, 3, 0, 0, 0, 0], [0, 5, 52, 1, 0, 0, 0], [0, 1, 1, 66, 0, 3, 0], [1, 0, 0, 0, 54, 0, 0], [0, 0, 0, 1, 0, 58, 1], [0, 0, 0, 1, 0, 0, 64]]),
#     np.array([[47, 7, 0, 0, 4, 0, 0], [3, 52, 2, 1, 0, 0, 0], [0, 6, 45, 7, 0, 0, 0], [0, 0, 2, 66, 0, 3, 0], [3, 0, 0, 0, 52, 0, 0], [0, 0, 0, 2, 0, 57, 1], [0, 0, 0, 1, 0, 0, 64]]),
#     np.array([[44, 4, 4, 0, 6, 0, 0], [1, 50, 7, 0, 0, 0, 0], [1, 5, 48, 4, 0, 0, 0], [0, 1, 0, 66, 0, 4, 0], [7, 0, 0, 0, 48, 0, 0], [0, 0, 0, 1, 0, 58, 1], [0, 0, 0, 1, 0, 0, 64]]),
#     np.array([[56, 1, 0, 0, 1, 0, 0], [0, 58, 0, 0, 0, 0, 0], [0, 3, 54, 1, 0, 0, 0], [0, 0, 1, 70, 0, 0, 0], [2, 0, 0, 0, 53, 0, 0], [0, 0, 0, 1, 0, 58, 1], [0, 0, 0, 0, 0, 1, 64]])
# ]

matrices_confusion = [
    np.array([[29, 9, 1, 9, 0, 10, 0], [7, 24, 19, 6, 1, 1, 0], [3, 2, 55, 0, 11, 0, 0], [5, 7, 2, 44, 0, 0, 0], [0, 0, 1, 0, 58, 0, 1], [2, 0, 0, 0, 0, 53, 0], [0, 0, 1, 0, 0, 0, 64]]),
    np.array([[28, 6, 8, 4, 6, 6, 0], [7, 10, 19, 1, 17, 1, 3], [3, 0, 47, 0, 14, 1, 6], [6, 2, 17, 10, 19, 0, 4], [0, 0, 13, 0, 45, 1, 1], [5, 0, 10, 4, 8, 28, 0], [0, 1, 0, 0, 0, 0, 64]]),
    np.array([[29, 7, 5, 7, 2, 8, 0], [9, 15, 17, 2, 12, 2, 1], [4, 3, 45, 1, 14, 1, 3], [4, 3, 17, 17, 16, 1, 0], [1, 1, 0, 0, 57, 0, 1], [2, 0, 1, 9, 0, 43, 0], [0, 1, 0, 0, 0, 0, 64]]),
    np.array([[0, 0, 58, 0, 0, 0, 0], [0, 0, 58, 0, 0, 0, 0], [0, 0, 71, 0, 0, 0, 0], [0, 0, 58, 0, 0, 0, 0], [0, 0, 60, 0, 0, 0, 0], [0, 0, 55, 0, 0, 0, 0], [0, 0, 65, 0, 0, 0, 0]]),
    np.array([[37, 7, 0, 6, 0, 8, 0], [4, 35, 12, 7, 0, 0, 0], [1, 2, 62, 0, 6, 0, 0], [5, 7, 1, 45, 0, 0, 0], [0, 0, 1, 0, 58, 0, 1], [1, 0, 0, 0, 0, 54, 0], [0, 0, 1, 0, 0, 0, 64]]),
    np.array([[48, 2, 0, 5, 0, 3, 0], [1, 47, 2, 7, 0, 1, 0], [0, 1, 69, 1, 0, 0, 0], [4, 1, 1, 52, 0, 0, 0], [0, 0, 2, 0, 58, 0, 0], [3, 0, 0, 0, 0, 52, 0], [0, 0, 0, 0, 1, 0, 64]]),
    np.array([[31, 6, 7, 6, 1, 7, 0], [9, 24, 13, 2, 8, 1, 1], [2, 5, 46, 1, 13, 1, 3], [4, 4, 16, 23, 10, 1, 0], [1, 1, 0, 0, 57, 0, 1], [2, 1, 0, 6, 0, 46, 0], [0, 1, 0, 0, 0, 0, 64]]),
    np.array([[1, 0, 54, 0, 0, 1, 2], [0, 0, 57, 0, 0, 0, 1], [0, 0, 70, 0, 0, 0, 1], [0, 0, 53, 0, 0, 1, 4], [0, 0, 60, 0, 0, 0, 0], [2, 0, 45, 0, 0, 0, 8], [0, 0, 65, 0, 0, 0, 0]])
]

# Trazar las matrices de confusión
for i, matrix in enumerate(matrices_confusion):
    print("Matriz de confusión", i+1)
    plot_confusion_matrix(matrix, classes)
